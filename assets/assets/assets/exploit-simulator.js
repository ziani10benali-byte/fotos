// Simulador de exploit para demostración educativa

document.addEventListener('DOMContentLoaded', function() {
    const startBtn = document.getElementById('start-btn');
    const resetBtn = document.getElementById('reset-btn');
    const outputDiv = document.getElementById('exploit-output');
    
    let simulationInterval;
    let step = 0;
    
    const steps = [
        "[+] Inicializando exploit...",
        "[+] Detectando navegador: Safari WebKit",
        "[+] Versión detectada: iOS 4.2.1",
        "[+] Preparando payload malicioso...",
        "[+] Creando desbordamiento de búfer...",
        "[!] Sobreescribiendo memoria...",
        "[!] Inyectando shellcode...",
        "[!] Bypasseando ASLR...",
        "[!] Escalando privilegios...",
        "[!] Accediendo a API del sistema...",
        "[!] Ejecutando: system('shutdown -h now')",
        "[✓] EXPLOIT EXITOSO",
        "[!] En un dispositivo vulnerable, esto causaría:",
        "[!] 1. Ejecución de código arbitrario",
        "[!] 2. Acceso completo al sistema",
        "[!] 3. Posible apagado del dispositivo",
        "[!] --- SIMULACIÓN COMPLETADA ---",
        "[!] Esta vulnerabilidad fue parcheada en 2011",
        "[!] Los dispositivos modernos son inmunes"
    ];
    
    startBtn.addEventListener('click', function() {
        if (simulationInterval) {
            clearInterval(simulationInterval);
        }
        
        // Deshabilitar botón durante simulación
        startBtn.disabled = true;
        startBtn.innerHTML = '<i class="fas fa-sync fa-spin"></i> Simulando...';
        
        // Limpiar output anterior
        outputDiv.innerHTML = '';
        step = 0;
        
        // Iniciar simulación
        simulationInterval = setInterval(function() {
            if (step < steps.length) {
                const line = document.createElement('div');
                line.className = 'output-line';
                line.textContent = steps[step];
                
                // Color diferente para líneas importantes
                if (steps[step].includes('[!]')) {
                    line.style.color = '#dc2626';
                    line.style.fontWeight = 'bold';
                } else if (steps[step].includes('[✓]')) {
                    line.style.color = '#10b981';
                    line.style.fontWeight = 'bold';
                }
                
                outputDiv.appendChild(line);
                outputDiv.scrollTop = outputDiv.scrollHeight;
                step++;
            } else {
                clearInterval(simulationInterval);
                startBtn.disabled = false;
                startBtn.innerHTML = '<i class="fas fa-play"></i> Iniciar Simulación de Ataque';
                
                // Mostrar explicación final
                setTimeout(function() {
                    showNotification('Simulación completada. Esto fue solo una demostración educativa.', 'success');
                }, 500);
            }
        }, 800);
    });
    
    resetBtn.addEventListener('click', function() {
        if (simulationInterval) {
            clearInterval(simulationInterval);
        }
        
        outputDiv.innerHTML = `
            <div class="output-line">[+] Inicializando exploit...</div>
            <div class="output-line">[+] Target: Dispositivo iOS</div>
            <div class="output-line">[+] Navegador: Safari WebKit</div>
        `;
        
        startBtn.disabled = false;
        startBtn.innerHTML = '<i class="fas fa-play"></i> Iniciar Simulación de Ataque';
        step = 0;
    });
    
    // Función para mostrar notificación
    function showNotification(message, type) {
        // Implementación simple
        alert(`[${type.toUpperCase()}] ${message}`);
    }
});
